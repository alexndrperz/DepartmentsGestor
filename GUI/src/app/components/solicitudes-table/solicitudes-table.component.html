
<main style=" max-height: 100vh; padding-top: 40px;">
    <section class="container-sm">
        <h1>
            Solicitudes
        </h1>
        <hr > 
        <section class="cont-pag-filters">
          <section class="inp-filters">


          <mat-form-field>
            <mat-label>Filtrar seg√∫n</mat-label>
            <mat-select>
              <mat-option *ngFor="let option of Soptions" [value]="option">
                {{option}}
              </mat-option>
            </mat-select>
          </mat-form-field>
        

        <section class="autocomplete" style="max-height: 56px; overflow: hidden;">
          <mat-form-field class="example-full-width">
            <mat-label>Departamento</mat-label>
            <input type="text"
                   placeholder="Pick one"
                   aria-label="Number"
                   matInput
                   [formControl]="myControl"
                   [matAutocomplete]="auto">
            <mat-autocomplete #auto="matAutocomplete" (optionSelected)="filterBy($event)">
              <mat-option *ngFor="let option of options" [value]="option"> 
                {{option}}
              </mat-option>
            </mat-autocomplete>
          </mat-form-field>
        </section>
      </section>

          <mat-paginator [length]="length"
                        [pageSize]="10"
                        aria-label="Select page" hidePageSize="true"
                        (page)="goTopage($event)" [ngStyle]="{'max-width':'260px'}">
          </mat-paginator>
       </section>


        <section class="filters" *ngIf="encargados_view">
          <div style="display: flex; gap: 10px;">
            <p>Filtrar: </p>
          <select class="form-select" [(ngModel)] = "filter_selection" (change)="filterData()">
            <option value="1" >Propias</option>
            <option value="2">Por departamento</option>
          </select>
          </div>
          

          <button class="btn btn-outline-primary" (click)="getLink()">
            Copiar link departamento
          </button>

        </section>
        <hr>
        <table class="table table-hover">
            <thead>
              <tr>
                <th *ngFor="let header of ownHeaders">{{header}} </th>
              </tr>
            </thead> 
            <tbody  *ngIf="!encargados_view">
              <tr *ngFor ="let solicitud of solicitudes">
                <td>{{solicitud.id}}</td>
                <td>{{solicitud.department.name}}</td>
                <td>{{solicitud.producto.name}}</td>
                <td>{{solicitud.createdAt}}</td>
                <td>{{solicitud.quantity_asked}}</td>
                <td>{{solicitud.name}}</td>
                <td>{{solicitud.email}}</td>
                <td>{{solicitud.status}}</td>
                <td class="buttons-td">
                    <button class="btn btn-outline-success " type="button" *ngIf="solicitud.status  == 'En proceso'"  (click)="modifyStatus(2,solicitud.id)" >Aprobar</button>
                    <button class="btn btn-outline-primary"  (click)="modifyStatus(2,solicitud.id)" *ngIf="solicitud.status == 'Aprobada'" type="button">Entregar</button>
                    <button class="btn btn-outline-danger " type="button" *ngIf="solicitud.status  == 'En proceso'"   (click)="modifyStatus(1,solicitud.id)">Rechazar</button>
                    <button class="btn btn-outline-primary" *ngIf="solicitud.status=='Rechazada' || solicitud.status=='Entregada'">Ver detalles</button>
                  </td>
                
              </tr>
            </tbody>
            <tbody  *ngIf="encargados_view">
              <tr *ngFor ="let solicitud of solicitudes">
                <td>{{solicitud.id}}</td>
                <td>{{solicitud.createdAt}}</td>
                <td>{{solicitud.name}}</td>
                <td>{{solicitud.producto.name}}</td>
                <td>{{solicitud.quantity_asked}}</td>
                <td>{{solicitud.status}}</td>
              </tr>
            </tbody>
          </table>
          <section style="display: flex; justify-content: flex-end;">

          </section>
    </section>
</main>